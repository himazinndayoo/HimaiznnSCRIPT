local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AllowFriends"
screenGui.ResetOnSpawn = false
screenGui.Parent = game:GetService("CoreGui")

local button = Instance.new("TextButton")
button.Name = "DraggableButton"
button.Size = UDim2.fromOffset(140, 50)
button.Position = UDim2.fromOffset(200, 200)  -- Starting position
button.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
button.BorderSizePixel = 0
button.Text = "Allow Friends"
button.TextColor3 = Color3.fromRGB(255, 255, 255)
button.Font = Enum.Font.GothamBold
button.TextSize = 18
button.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = button

local stroke = Instance.new("UIStroke")
stroke.Color = Color3.fromRGB(0, 125, 255)
stroke.Thickness = 1.5
stroke.Transparency = 0.3
stroke.Parent = button

local dragging = false
local dragStart = nil
local startPos = nil

local function updateInput(input)
    if dragging then
        local delta = input.Position - dragStart
        button.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end

button.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = button.Position
    end
end)

button.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        updateInput(input)
    end
end)

button.MouseButton1Click:Connect(function()
    game:GetService("ReplicatedStorage"):WaitForChild("Packages"):WaitForChild("Net"):WaitForChild("RE/PlotService/ToggleFriends"):FireServer()
end)

button.TouchTap:Connect(function()
    game:GetService("ReplicatedStorage"):WaitForChild("Packages"):WaitForChild("Net"):WaitForChild("RE/PlotService/ToggleFriends"):FireServer()
end)

-- ▼▼▼ ここから Fキーでオンにする処理 ▼▼▼
UserInputService.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == Enum.KeyCode.F then
        game:GetService("ReplicatedStorage")
        :WaitForChild("Packages")
        :WaitForChild("Net")
        :WaitForChild("RE/PlotService/ToggleFriends")
        :FireServer()
    end
end)
-- ▲▲▲ ここまで Fキー処理 ▲▲▲
